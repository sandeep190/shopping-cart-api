<!DOCTYPE html>
<html
  lang="en"
  class="light-style layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free"
>
  <head>
    <meta charset="utf-8" />
    <title>
      {{ .title }}
    </title>
    <meta name="description" content="" />
    {{ template "admin_header.html"}}
  </head>
  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->
        {{ template "admin_sidebar.html"}}
        <!-- / Menu -->
        <!-- Layout container -->
        <div class="layout-page">
          {{ template "admin_top_header.html" }}
          <div class="content-wrapper">
            <!-- Content -->
            <div class="container-xxl flex-grow-1 container-p-y">
              <h4 class="fw-bold py-3 mb-4">
                <span class="text-muted fw-light">Category</span> Details
              </h4>
              <!-- Basic Layout -->
              <div class="row">
                <div class="col-xl">
                  <div class="card mb-4">
                    <div class="card-body">
                      <form id="categorydata"
                        action="/admin/master/savecategory"
                        method="post"
                        enctype="multipart/form-data"
                      >
                        <div class="mb-3">
                          <label class="form-label" for="basic-default-fullname"
                            >Category Name</label
                          >
                          <input
                            type="text"
                            class="form-control"
                            id="basic-default-fullname"
                            name="name"
                          />
                        </div>
                        <div class="mb-3">
                         
                          <label for="defaultSelect" class="form-label"
                            >Perent Category</label
                          >
                          <select
                            id="defaultSelect"
                            class="form-select"
                            name="parent_id"
                          >
                            <option value="0">Select One</option>
                            {{ range $key, $value := .category.categories}}
                            <option value="{{ $value.id}}">
                              {{ $value.name }}
                            </option>
                            {{ end }}
                          </select>
                        </div>

                        <div class="mb-3">
                          <label for="formFile" class="form-label">Image</label>
                          <input
                            class="form-control"
                            type="file"
                            id="formFile"
                            name="image"
                          />
                        </div>
                        <div class="mb-3">
                          <label class="form-label" for="basic-default-message"
                            >Description</label
                          >
                          <textarea
                            id="basic-default-message"
                            class="form-control"
                            name="description"
                          ></textarea>
                        </div>
                        <button class="btn btn-primary">
                          Save
                        </button>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <table id="table_id" class="display">
                <thead>
                  <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>parent</th>
                    <th>Image</th>
                    <th>Description</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  {{ range $key, $value := .category.categories }}
                  <tr>
                    <td>{{ $value.id }}</td>
                    <td>{{ $value.name}}</td>
                    <td>{{ $value.parent_id}}</td>
                    <td>{{ $len := len $value.image_urls}}
                      {{ if ge $len 1}}
                      {{$value.image_urls}}
                      {{end}}
                    </td>
                    <td>{{$value.description}}</td>
                    <td></td>
                  </tr>
                  {{ end }}
                  
                </tbody>
              </table>
              <link
                rel="stylesheet"
                type="text/css"
                href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css"
              />

              <script
                type="text/javascript"
                charset="utf8"
                src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"
              ></script>
            </div>
            <!-- / Content -->
            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>
      <!-- Overlay -->
      <script>
        $(document).ready(function () {
    
          $("#table_id").DataTable();

          $("form#categorydata").submit(function(e) {
            e.preventDefault();    
            var formData = new FormData(this);
        
            $.ajax({
                url: '',
                type: 'POST',
                data: formData,
                success: function (data) {
                    console.log(data);
                    window.location.reload();
                },
                cache: false,
                contentType: false,
                processData: false
            });
        });
        });
      </script>
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->
    {{ template "admin_footer.html"}}
  </body>
</html>

